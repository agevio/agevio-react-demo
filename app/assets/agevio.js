"use strict";(function(){function e(){var o=i();return r||a||(o.noConflict=function(){return n.translate=t,o}),a||(o["new"]=function(){return e()}),o}var n=this,t=n.translate,r="undefined"!=typeof exports,o="undefined"!=typeof module&&module.exports,a="function"==typeof define&&define.amd,i=function(){function e(e){if(-1===c(m.events).indexOf(e))throw new TypeError(l()+' "type" argument must be a valid event type')}function n(e){if("function"!=typeof e)throw new TypeError(l()+' "listener" argument must be a function')}function t(e){return"string"==typeof e}function o(e){return"object"===("undefined"==typeof e?"undefined":v(e))&&null!==e}function a(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){return"undefined"==typeof e}function u(){if(m.shouldWarn){var e;(e=console).warn.apply(e,[l()].concat(Array.prototype.slice.call(arguments)))}}function l(){return"Agevio.js:"}function f(e,n){return a(n)?e.replace(/#{(\d+)}/g,function(e,t){return"undefined"!=typeof n[t]?n[t]:e}):o(n)?e.replace(/#{(.+)}/g,function(e,t){return"undefined"!=typeof n[t]?n[t]:e}):e}function s(e,n,t){if(r){var o=require("url").parse(e),a=require("https"),i={hostname:o.host,port:443,path:o.path,method:"GET"},u=a.request(i,function(e){e.on("data",function(e){return n(JSON.parse(e))})});u.end(),u.on("error",t)}else!function(){var r=new XMLHttpRequest;r.open("GET",e),r.onreadystatechange=function(){var e=[];if(n&&n.call&&(e=[null,n,t]),4===r.readyState){var o=e[Math.floor(r.status/200)];if(o){var a=void 0;try{a=JSON.parse(r.responseText)}catch(i){a=null}o(a,r)}}},r.send()}()}function c(e){var n=[];for(var t in e)e.hasOwnProperty(t)&&n.push(t);return n}function d(e){return m.code2lang[e]}function g(e){return m.lang2code[e]}function p(e){var n=arguments.length<=1||void 0===arguments[1]?"":arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!t(e))throw new TypeError(l()+" key should be a string");if(!t(n))throw new TypeError(l()+" defaultMessage should be a string");if(!o(r)&&!a(r))throw new TypeError(l()+" params should be an object or an array");var i=y(e,n);return f(i,r)}function y(e,n){var t=m.locale,r=m.fallback,o=m.messages;if(i(o[e])){var a="missing translation key "+e;return""===n?a:(u(a),n)}var l=function(){var a=o[e]._;if(a!==n&&u("default message for key "+e+' stored in translation file and one passed to translation function differ:\n "'+a+'"\n\nand\n\n "'+n+'"\n\nThat mean translation may be outdated.'),i(o[e][t])){u("missing locale "+t+" for key "+e);var l=function(){return""===n||a===n?a:n};return r===t?{v:l()}:i(o[e][r])?(u("missing fallback locale "+r+" for key "+e),{v:l()}):{v:o[e][r]}}return{v:o[e][t]}}();return"object"===("undefined"==typeof l?"undefined":v(l))?l.v:void 0}function h(){s("https://agevio.com/api/files/"+m.key,function(e){m.messages=e.m,m.lang2code=e.lang2code,m.code2lang=e.code2lang,p.emit("initialized")},function(e,n){console.error(e)})}var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},m={key:"",messages:{},lang2code:{},code2lang:{},locale:"en",fallback:"en",shouldWarn:!0,events:{initialized:[],localeChanged:[],fallbackChanged:[]}};return p.state=m,p.initialize=function(e){var n=e.key,t=e.defaultLocale,r=e.shouldWarn;return i(n)&&console.error("Agevio.js: key can't be empty"),m.key=n,m.locale=t||"en",m.shouldWarn=r||!0,h(n),this},p.getLocale=function(e){return t(e)?g(e):m.locale},p.setLocale=function(e){return i(d(e))?u("unknown locale - "+e):(m.locale=e,this.emit("localeChanged",e)),this},p.getLocales=function(){return c(m.code2lang)},p.getFallback=function(){return m.fallback},p.setFallback=function(e){return i(d(e))?u("unknown locale - "+e):(m.fallback=e,this.emit("fallbackChanged",e)),this},p.getLanguage=function(e){return d(t(e)?e:this.getLocale())},p.setLanguage=function(e){var n=g(e);return i(n)?u("unknown language - "+e):this.setLocale(n),this},p.getLanguages=function(){return c(m.lang2code)},p.localize=function(){},p.on=function(t,r){return e(t),n(r),m.events[t].push(r),this},p.remove=function(t,r){if(e(t),"undefined"==typeof r)m.events[t]=[];else{n(r);for(var o=-1,a=m.events[t],i=a.length;i-- >0;)if(a[i]===r||a[i].listener&&a[i].listener===r){o=i;break}if(0>o)return this;if(1===a.length)m.events[t]=[];else{for(var i=o,u=i+1,l=a.length;l>u;i+=1,u+=1)a[i]=a[u];a.pop()}}return this},p.emit=function(n){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;t>o;o++)r[o-1]=arguments[o];return e(n),m.events[n].forEach(function(e){setTimeout(e.apply(void 0,r),1)}),this},p};if(r)o?exports=module.exports=e():exports.translate=e();else if(a){var u=e();define("translate",[],function(){return u})}else n.translate=e()}).call(this);